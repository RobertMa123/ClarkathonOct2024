<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Dive</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f4f4f9;
        }
        .container {
            text-align: center;
            width: 100%;
            max-width: 500px;
            padding: 20px;
            background-color: #fff;
            border: 1px solid #ddd;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }
        .title {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        input[type="text"], input[type="number"] {
            width: 80%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        input[type="submit"] {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        input[type="submit"]:hover {
            background-color: #45a049;
        }
        select {
            width: 80%;
            padding: 10px;
            margin-top: 20px;
            border-radius: 5px;
            border: 1px solid #ddd;
            margin-left: auto;
            margin-right: auto;
            display: block; 
        }
        .summary {
            margin-top: 20px;
            font-size: 16px;
            color: #333;
        }
        .spinner {
            display: none;
            border: 8px solid #f3f3f3;
            border-top: 8px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">Quick Dive</div>
        <h4>Making it easier to find your community</h4>
        <form id="keywordForm" method="POST" action="/search">
            <label for="keyword">What community are you looking for?</label><br>
            <input type="text" id="keyword" name="keyword"><br>

            <input type="checkbox" id="surpriseMeCheckbox">
            <label for="surpriseMeCheckbox">Surprise Me!</label><br>

            <label for="numCommunities">Number of communities to display:</label><br>
            <input type="number" id="numCommunities" name="numCommunities" min="1" required><br>
            
            <label>Select platforms to search:</label><br>
            <input type="checkbox" id="redditCheckbox" name="platforms" value="reddit" checked>
            <label for="redditCheckbox">Reddit</label><br>
            <input type="checkbox" id="facebookCheckbox" name="platforms" value="facebook" checked>
            <label for="facebookCheckbox">Facebook</label><br>
            <input type="checkbox" id="tumblrCheckbox" name="platforms" value="tumblr" checked>
            <label for="tumblrCheckbox">Tumblr</label><br>

            <input type="submit" value="Search">
        </form>

        <div class="spinner" id="loadingSpinner"></div>

        <select id="communityDropdown" style="display:none;">
            <option value="">Select a community</option>
        </select>

        <div class="summary" id="communitySummary" style="display:none;"></div>
    </div>

    <script>
        const randomKeywords = [
            'cats', 'dogs', 'travel', 'cooking', 'fitness', 'programming', 'movies', 
            'books', 'gaming', 'music', 'art', 'photography', 'crafts', 'sports', 
            'fashion', 'beauty', 'parenting', 'science', 'technology', 'health', 
            'food', 'gardening', 'history', 'finance', 'investing', 'DIY', 'home improvement',
            'mental health', 'spirituality', 'pet care', 'self-improvement', 'photography tips', 
            'weight loss', 'vegan cooking', 'sustainable living', 'minimalism', 'personal development',
            'hiking', 'fishing', 'hunting', 'outdoors', 'camping', 'knitting', 'sewing', 
            'literature', 'poetry', 'comic books', 'anime', 'manga', 'role-playing games', 
            'board games', 'card games', 'cryptocurrency', 'web development', 'data science', 
            'machine learning', 'artificial intelligence', 'virtual reality', 'augmented reality', 
            'online learning', 'public speaking', 'career development', 'job hunting', 'networking', 
            'graphic design', 'illustration', 'user experience', 'cooking tips', 'meal prep', 
            'baking', 'barbecue', 'wine tasting', 'cocktail recipes', 'food photography', 
            'home brewing', 'craft beer', 'whiskey tasting', 'tea', 'coffee', 
            'sci-fi', 'fantasy', 'mystery', 'thriller', 'romance', 'historical fiction', 
            'biography', 'self-help', 'children\'s books', 'young adult', 'classic literature', 
            'travel photography', 'travel tips', 'road trips', 'backpacking', 
            'cruises', 'luxury travel', 'travel hacks', 'eco-friendly travel', 'cultural exchange', 
            'foreign languages', 'music production', 'music theory', 'musical instruments', 
            'live music', 'concerts', 'musical theatre', 'dance', 'comedy', 'stand-up', 
            'improv', 'social activism', 'volunteering', 'charity', 'nonprofits', 
            'community service', 'sustainability', 'recycling', 'climate change', 
            'environmentalism', 'urban gardening', 'homesteading', 'cooking challenges', 
            'culinary arts', 'fashion design', 'vintage fashion', 'sustainable fashion', 
            'makeup tutorials', 'skincare routines', 'hairstyling', 'nail art', 
            'mindfulness', 'meditation', 'yoga', 'pilates', 'nutrition', 'keto diet', 
            'paleo diet', 'intermittent fasting', 'mental health awareness', 'depression support', 
            'anxiety support', 'LGBTQ+ issues', 'women\'s rights', 'men\'s rights', 
            'parenting hacks', 'home organization', 'time management', 'study tips', 
            'writing', 'screenwriting', 'blogging', 'vlogging', 'podcasting', 'music reviews', 
            'film critiques', 'game reviews', 'book reviews'
        ];
        document.getElementById('keywordForm').addEventListener('submit', function(event) {
            event.preventDefault(); 

            let keyword = document.getElementById('keyword').value;

            if (document.getElementById('surpriseMeCheckbox').checked) {
                keyword = randomKeywords[Math.floor(Math.random() * randomKeywords.length)];
                document.getElementById('keyword').value = keyword;
            }

            if (!keyword) {
                alert("Please enter a keyword or check 'Surprise Me!'");
                return;
            }

            const numCommunities = document.getElementById('numCommunities').value;

            const platforms = [];
            if (document.getElementById('redditCheckbox').checked) {
                platforms.push('reddit');
            }
            if (document.getElementById('facebookCheckbox').checked) {
                platforms.push('facebook');
            }
            if (document.getElementById('tumblrCheckbox').checked) {
                platforms.push('tumblr');
            }

            const spinner = document.getElementById('loadingSpinner');
            spinner.style.display = 'block';

            fetch('/search', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ keyword: keyword, numCommunities: numCommunities, platforms: platforms })
            })
            .then(response => response.json())
            .then(data => {
                spinner.style.display = 'none';
                const dropdown = document.getElementById('communityDropdown');
                dropdown.style.display = 'block';
                dropdown.innerHTML = '';

                const defaultOption = document.createElement('option');
                defaultOption.text = 'Select a community';
                defaultOption.value = '';
                dropdown.add(defaultOption);

                data.result.forEach((item, index) => {
                    const membersText = item.num_members ? ` (Members: ${item.num_members})` : '';
                    const option = document.createElement('option');
                    option.text = `${item.source}: ${item.community}${membersText}`;
                    option.value = index;
                    dropdown.add(option);
                });

                dropdown.addEventListener('change', function() {
                    const selectedIndex = dropdown.value;
                    if (selectedIndex !== '') {
                        const selectedCommunity = data.result[selectedIndex];
                        const summaryDiv = document.getElementById('communitySummary');
                        summaryDiv.style.display = 'block';
                        summaryDiv.innerHTML = `<strong>Summary:</strong> ${selectedCommunity.summary}<br><a href="${selectedCommunity.link}" target="_blank">Visit Community</a>`;
                    } else {
                        document.getElementById('communitySummary').style.display = 'none';
                    }
                });
            })
            .catch(error => {
                spinner.style.display = 'none';
                console.error('Error:', error);
            });
        });
    </script>
</body>
</html>
